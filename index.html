<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DNS Subdomain Scanner</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            max-width: 800px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        input {
            flex: 1;
            padding: 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
        }

        input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        button {
            padding: 15px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-left: 10px;
            vertical-align: middle;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .results {
            margin-top: 30px;
            max-height: 500px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .results::-webkit-scrollbar {
            width: 8px;
        }

        .results::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .results::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
        }

        .subdomain-item {
            background: #f8f9fa;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            animation: fadeIn 0.3s ease-out;
            transition: all 0.3s;
        }

        .subdomain-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateX(-10px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .subdomain-url {
            color: #333;
            font-weight: 500;
            font-size: 1.1em;
            text-decoration: none;
            transition: color 0.3s;
        }

        .subdomain-url:hover {
            color: #667eea;
        }

        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .status-checking {
            background: #ffeaa7;
            color: #fdcb6e;
        }

        .status-active {
            background: #55efc4;
            color: #00b894;
        }

        .status-inactive {
            background: #fab1a0;
            color: #e17055;
        }

        .error-message {
            background: #ff6b6b;
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            animation: shake 0.5s;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
            color: #1976d2;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
            margin-top: 5px;
        }

        .no-results {
            text-align: center;
            padding: 40px;
            color: #999;
            font-size: 1.1em;
        }

        @media (max-width: 600px) {
            .container {
                padding: 25px;
            }

            h1 {
                font-size: 2em;
            }

            .input-group {
                flex-direction: column;
            }

            button {
                width: 100%;
            }

            .stats {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç DNS Scanner</h1>
        <p class="subtitle">Descubre subdominios de cualquier dominio</p>
        
        <div class="info-box">
            <strong>‚ÑπÔ∏è Nota:</strong> Este scanner utiliza m√©todos p√∫blicos y puede no encontrar todos los subdominios existentes. Los resultados dependen de la informaci√≥n p√∫blicamente disponible.
        </div>

        <div class="input-group">
            <input 
                type="text" 
                id="domainInput" 
                placeholder="Ingresa un dominio (ej: ripley.com.pe)"
                value=""
            >
            <button id="scanButton" onclick="startScan()">
                Escanear
            </button>
        </div>

        <div id="stats" class="stats" style="display: none;">
            <div class="stat-item">
                <div class="stat-number" id="totalFound">0</div>
                <div class="stat-label">Subdominios encontrados</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="activeCount">0</div>
                <div class="stat-label">Activos</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="scanProgress">0%</div>
                <div class="stat-label">Progreso</div>
            </div>
        </div>

        <div id="results" class="results"></div>
    </div>

    <script>
        // Lista com√∫n de subdominios para verificar
        const commonSubdomains = [
            'www', 'mail', 'ftp', 'localhost', 'webmail', 'smtp', 'pop', 'ns1', 'webdisk', 'ns2', 
            'cpanel', 'whm', 'autodiscover', 'autoconfig', 'ns', 'test', 'api', 'app', 'admin',
            'blog', 'dev', 'staging', 'beta', 'alpha', 'demo', 'docs', 'help', 'support', 'portal',
            'secure', 'shop', 'store', 'cdn', 'assets', 'images', 'img', 'static', 'media',
            'mobile', 'm', 'api2', 'api1', 'web', 'old', 'new', 'backup', 'server', 'vpn',
            'remote', 'ssh', 'sftp', 'mysql', 'db', 'database', 'panel', 'git', 'repo',
            'jenkins', 'gitlab', 'jira', 'confluence', 'wiki', 'forum', 'community', 'status',
            'monitor', 'nagios', 'zabbix', 'grafana', 'prometheus', 'elastic', 'kibana', 'logstash',
            'search', 'solr', 'elasticsearch', 'redis', 'cache', 'memcached', 'rabbitmq', 'kafka',
            'jenkins', 'ci', 'cd', 'build', 'deploy', 'docker', 'kubernetes', 'k8s', 'registry',
            'nexus', 'artifactory', 'sonar', 'sonarqube', 'quality', 'qa', 'uat', 'prod',
            'production', 'development', 'local', 'services', 'microservices', 'gateway', 'proxy',
            'lb', 'loadbalancer', 'balancer', 'firewall', 'waf', 'ids', 'ips', 'siem',
            'auth', 'oauth', 'sso', 'login', 'signin', 'signup', 'register', 'account', 'accounts',
            'user', 'users', 'profile', 'profiles', 'dashboard', 'console', 'manager', 'crm',
            'erp', 'hr', 'finance', 'accounting', 'billing', 'invoice', 'payment', 'payments',
            'checkout', 'cart', 'order', 'orders', 'customer', 'customers', 'client', 'clients',
            'partner', 'partners', 'vendor', 'vendors', 'supplier', 'suppliers', 'contractor',
            'download', 'downloads', 'upload', 'uploads', 'file', 'files', 'share', 'cloud',
            'storage', 'backup', 'archive', 'archives', 'vault', 'secure', 'private', 'public',
            'internal', 'external', 'extranet', 'intranet', 'owa', 'exchange', 'outlook', 'mail1',
            'mail2', 'mx', 'mx1', 'mx2', 'email', 'newsletter', 'campaign', 'marketing', 'seo',
            'analytics', 'stats', 'statistics', 'metrics', 'reports', 'reporting', 'data',
            'bigdata', 'ai', 'ml', 'machinelearning', 'deeplearning', 'tensorflow', 'pytorch'
        ];

        let isScanning = false;
        let foundSubdomains = new Set();

        async function startScan() {
            if (isScanning) return;

            const domain = document.getElementById('domainInput').value.trim();
            if (!domain) {
                showError('Por favor ingresa un dominio v√°lido');
                return;
            }

            // Limpiar el dominio de protocolos si los tiene
            const cleanDomain = domain.replace(/^https?:\/\//, '').replace(/\/$/, '');

            isScanning = true;
            foundSubdomains.clear();
            
            const button = document.getElementById('scanButton');
            const resultsDiv = document.getElementById('results');
            const statsDiv = document.getElementById('stats');
            
            button.disabled = true;
            button.innerHTML = 'Escaneando<span class="spinner"></span>';
            resultsDiv.innerHTML = '';
            statsDiv.style.display = 'flex';

            // Resetear estad√≠sticas
            document.getElementById('totalFound').textContent = '0';
            document.getElementById('activeCount').textContent = '0';
            document.getElementById('scanProgress').textContent = '0%';

            try {
                // Primero intentar con m√©todos de descubrimiento de DNS
                await discoverSubdomains(cleanDomain);
                
                // Tambi√©n verificar subdominios comunes
                await checkCommonSubdomains(cleanDomain);

                if (foundSubdomains.size === 0) {
                    resultsDiv.innerHTML = '<div class="no-results">No se encontraron subdominios. Esto puede deberse a restricciones de CORS o a que el dominio no tiene subdominios p√∫blicos.</div>';
                }
            } catch (error) {
                showError('Error durante el escaneo: ' + error.message);
            } finally {
                isScanning = false;
                button.disabled = false;
                button.innerHTML = 'Escanear';
                document.getElementById('scanProgress').textContent = '100%';
            }
        }

        async function discoverSubdomains(domain) {
            const resultsDiv = document.getElementById('results');
            
            // Intentar usar servicios p√∫blicos de b√∫squeda de subdominios
            const services = [
                `https://api.hackertarget.com/hostsearch/?q=${domain}`,
                `https://crt.sh/?q=%.${domain}&output=json`
            ];

            for (const service of services) {
                try {
                    // Nota: Estos servicios pueden estar bloqueados por CORS
                    const response = await fetch(service, {
                        mode: 'cors',
                        headers: {
                            'Accept': 'application/json'
                        }
                    });
                    
                    if (response.ok) {
                        const data = await response.text();
                        parseAndAddSubdomains(data, domain);
                    }
                } catch (error) {
                    console.log(`Service ${service} failed:`, error);
                }
            }
        }

        function parseAndAddSubdomains(data, domain) {
            // Buscar patrones de subdominios en el texto
            const regex = new RegExp(`([a-zA-Z0-9.-]+\\.)?${domain.replace('.', '\\.')}`, 'gi');
            const matches = data.match(regex) || [];
            
            matches.forEach(match => {
                if (match && !foundSubdomains.has(match)) {
                    foundSubdomains.add(match);
                    addSubdomainToResults(match);
                }
            });

            updateStats();
        }

        async function checkCommonSubdomains(domain) {
            const totalSubdomains = commonSubdomains.length;
            let checked = 0;

            for (const subdomain of commonSubdomains) {
                if (!isScanning) break;

                const fullDomain = `${subdomain}.${domain}`;
                
                // Actualizar progreso
                checked++;
                const progress = Math.round((checked / totalSubdomains) * 100);
                document.getElementById('scanProgress').textContent = `${progress}%`;

                // Intentar verificar si el subdominio existe
                await checkSubdomain(fullDomain);
                
                // Peque√±a pausa para no sobrecargar
                await new Promise(resolve => setTimeout(resolve, 50));
            }
        }

        async function checkSubdomain(subdomain) {
            if (foundSubdomains.has(subdomain)) return;

            try {
                // Intentar hacer una petici√≥n para verificar si existe
                // Nota: Esto puede estar limitado por CORS
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 3000);

                const response = await fetch(`https://${subdomain}`, {
                    mode: 'no-cors',
                    signal: controller.signal
                });

                clearTimeout(timeoutId);

                // Si no hay error, probablemente existe
                foundSubdomains.add(subdomain);
                addSubdomainToResults(subdomain, true);
                updateStats();
            } catch (error) {
                // Si hay error pero no es abort, podr√≠a existir pero con restricciones
                if (error.name !== 'AbortError') {
                    // Podemos agregar subdominios conocidos comunes sin verificaci√≥n
                    if (commonSubdomains.slice(0, 20).some(common => subdomain.startsWith(common + '.'))) {
                        foundSubdomains.add(subdomain);
                        addSubdomainToResults(subdomain, false);
                        updateStats();
                    }
                }
            }
        }

        function addSubdomainToResults(subdomain, isActive = null) {
            const resultsDiv = document.getElementById('results');
            
            const item = document.createElement('div');
            item.className = 'subdomain-item';
            
            const status = isActive === null ? 'checking' : (isActive ? 'active' : 'inactive');
            const statusText = isActive === null ? 'Verificando' : (isActive ? 'Activo' : 'Posible');
            
            item.innerHTML = `
                <a href="https://${subdomain}" target="_blank" class="subdomain-url">
                    ${subdomain}
                </a>
                <span class="status-badge status-${status}">${statusText}</span>
            `;
            
            resultsDiv.appendChild(item);

            if (isActive) {
                incrementActiveCount();
            }
        }

        function updateStats() {
            document.getElementById('totalFound').textContent = foundSubdomains.size;
        }

        function incrementActiveCount() {
            const activeCount = document.getElementById('activeCount');
            activeCount.textContent = (parseInt(activeCount.textContent) + 1).toString();
        }

        function showError(message) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `<div class="error-message">${message}</div>`;
        }

        // Permitir escanear con Enter
        document.getElementById('domainInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !isScanning) {
                startScan();
            }
        });
    </script>
</body>
</html>
